{"version":3,"file":"csv-mapper.umd.min.js","sources":["../src/csv-mapper.ts"],"sourcesContent":[null],"names":["CsvMapper","EventTarget","constructor","fileInput","options","super","this","input","document","querySelector","HTMLInputElement","type","Error","opts","Object","assign","separator","enclosure","escape","guessMaxLines","outputSeparator","outputEnclosure","outputEscape","headers","remap","showUserControls","mappingInput","controlsContainer","columns","autoThreshold","allowUnmappedTargets","setInputValidity","beforeParse","beforeMap","afterMap","map","c","name","forEach","title","controlsEl","_resolveNode","_autoinsertContainer","mapping","rows","dialect","_onFileChange","bind","addEventListener","_ensureStyles","destroy","removeEventListener","dataset","csvMapperAutocreated","remove","getMapping","setMapping","_renderControls","_validateMapping","getHeaders","getRawRows","r","getDialect","requiredColumns","filter","required","mappedTargets","Set","values","v","missingRequired","col","has","isValid","length","validationEvent","CustomEvent","detail","mappedColumns","Array","from","dispatchEvent","setCustomValidity","message","join","reportValidity","validateMapping","_validateRequiredColumns","file","files","text","bpEvent","parsed","parseCSV","fromEntries","h","_autoMap","bmEvent","maybe","isArray","some","mappedRows","csv","_produceOutput","amEvent","error","console","warn","value","JSON","stringify","Boolean","spec","push","targetToSource","src","tgt","entries","find","allowDuplicates","emptyRows","out","outSep","outQuote","outEsc","headerRow","lines","toCsvRow","arr","row","srcHeaders","raw","String","val","transform","e","validate","_validate","msg","validationMessage","__errors__","field","el","innerHTML","_banner","selectOptions","currentTargetName","taken","Map","n","set","get","concat","count","disabled","sel","requiredMark","dupMark","bodyRows","current","validation","validationHtml","querySelectorAll","selectEl","getAttribute","used","best","score","s","_matchScore","srcHeader","norm","normalize","match","RegExp","test","Math","max","includes","similarity","ref","d","createElement","insertAdjacentElement","needSep","needQuote","needEsc","detectDialect","undefined","sep","quote","esc","_parseWithDialect","head","shift","objs","idx","maxLen","reduce","m","a","_","i","f","inQuotes","pop","seps","quotes","escapes","split","l","slice","Infinity","q","counts","mode","_mode","consistent","penalty","sepHits","_escRe","err","bestC","replace","needsQuote","toLowerCase","trim","b","grams","str","g","A","B","inter","total","min","validator","t","num","Number","isNaN","getElementById","style","id","textContent","appendChild"],"mappings":"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"}