{"version":3,"file":"csv-mapper.esm.min.js","sources":["../src/ui/renderer/default.ts","../src/ui/renderer/minimal.ts","../src/csvMapper.ts"],"sourcesContent":[null,null,null],"names":["DefaultUIRenderer","constructor","this","container","mappingChangeCallback","currentOptions","_ensureStyles","render","options","headers","length","innerHTML","_banner","validationDisplay","_renderValidationStatus","validation","mappingTable","_renderMappingTable","rowCount","_escape","dialect","separator","_attachEventListeners","onMappingChange","callback","updateValidation","validationElement","querySelector","outerHTML","destroy","showMessage","message","isValid","missingRequired","join","map","header","currentMapping","selectOptions","_generateSelectOptions","columnSpecs","currentTargetName","allMappings","usageCounts","Map","Object","values","forEach","target","set","get","spec","count","name","isCurrentTarget","disabled","allowDuplicates","selected","title","multiIndicator","querySelectorAll","select","addEventListener","sourceHeader","getAttribute","targetColumn","value","text","str","replace","id","document","getElementById","style","createElement","textContent","head","appendChild","MinimalUIRenderer","_renderValidationBadge","_renderMappingRow","badge","className","currentTarget","_generateOptions","CsvMapper","EventTarget","fileInput","super","input","HTMLInputElement","type","Error","opts","assign","enclosure","escape","guessMaxLines","outputSeparator","outputEnclosure","outputEscape","remap","showUserControls","mappingInput","controlsContainer","columns","autoThreshold","allowUnmappedTargets","setInputValidity","uiRenderer","beforeParse","beforeMap","afterMap","c","controlsEl","_resolveNode","_autoinsertContainer","mapping","rows","_onMappingChange","_onFileChange","bind","removeEventListener","dataset","csvMapperAutocreated","remove","getMapping","setMapping","_renderControls","_validateMapping","getHeaders","getRawRows","r","getDialect","requiredColumns","filter","required","mappedTargets","Set","v","col","has","validationEvent","CustomEvent","detail","mappedColumns","Array","from","dispatchEvent","setCustomValidity","reportValidity","mappedRows","csv","_produceOutput","amEvent","JSON","stringify","error","console","warn","validateMapping","_validateRequiredColumns","file","files","bpEvent","parsed","parseCSV","fromEntries","h","_autoMap","bmEvent","maybe","isArray","some","Boolean","push","targetToSource","src","tgt","entries","find","emptyRows","out","outSep","outQuote","outEsc","headerRow","lines","toCsvRow","arr","row","srcHeaders","raw","String","val","transform","e","validate","_validate","msg","validationMessage","__errors__","field","_getValidationStatus","renderOptions","used","best","score","s","_matchScore","srcHeader","norm","normalize","match","RegExp","test","Math","max","includes","similarity","ref","d","insertAdjacentElement","needSep","needQuote","needEsc","detectDialect","undefined","sep","quote","esc","_parseWithDialect","shift","objs","idx","maxLen","reduce","m","a","_","i","f","inQuotes","pop","seps","quotes","escapes","split","l","slice","Infinity","q","counts","mode","_mode","consistent","penalty","sepHits","_escRe","err","bestC","needsQuote","toLowerCase","trim","b","grams","g","A","B","inter","total","min","validator","t","num","Number","isNaN"],"mappings":"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"}